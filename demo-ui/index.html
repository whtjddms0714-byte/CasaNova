---
layout: default
title: CasaNova – 시작하기
---

<h1>CasaNova 시뮬레이터</h1>
<p>아래 정보를 입력한 뒤, 대출 여부를 선택하면 다음 단계로 이동합니다.</p>

<form id="user-form">
  <fieldset>
    <legend><strong>기본 정보</strong></legend>
    <label>
      월 소득 (원)
      <input
        type="number"
        id="income_monthly"
        required
        placeholder="예: 4000000"
      />
    </label>
    <br />
    <label>
      신용점수
      <input type="number" id="credit_score" required placeholder="예: 750" />
    </label>
    <br />
    <label>
      DSR 비율 (0~1 사이, 예: 0.4)
      <input type="number" step="0.01" id="dsr_ratio" value="0.4" required />
    </label>
    <br />
    <label>
      기존 부채 원금 (원)
      <input type="number" id="existing_debt" value="0" />
    </label>
    <br />
    <label>
      기존 부채 월 상환액 (원)
      <input type="number" id="existing_debt_monthly_payment" value="0" />
    </label>
    <br />
    <label>
      기혼 여부
      <input type="checkbox" id="married" />
    </label>
    <br />
    <label>
      첫 직장(사회초년생) 여부
      <input type="checkbox" id="first_job" />
    </label>
  </fieldset>

  <fieldset style="margin-top: 1rem">
    <legend><strong>부동산 관련 정보</strong></legend>
    <label>
      보유 자산 (원)
      <input type="number" id="asset" value="0" required />
    </label>
    <br />
    <label>
      예산 상한 (만원 단위, 선택)
      <input type="number" id="budget_limit" placeholder="예: 60000 (6억)" />
    </label>
    <br />
    <label>
      희망 지역 (구 이름, 예: 강남구)
      <input type="text" id="target_gu" placeholder="예: 강남구" />
    </label>
  </fieldset>

  <fieldset style="margin-top: 1rem">
    <legend><strong>인프라 가중치 (선택, 기본값 5·4·3·2)</strong></legend>
    <label>
      공원 가중치
      <input type="number" id="w_park" value="5" />
    </label>
    <br />
    <label>
      학교 가중치
      <input type="number" id="w_school" value="4" />
    </label>
    <br />
    <label>
      마트 가중치
      <input type="number" id="w_mart" value="3" />
    </label>
    <br />
    <label>
      교통(역) 가중치
      <input type="number" id="w_transport" value="2" />
    </label>
  </fieldset>

  <fieldset style="margin-top: 1rem">
    <legend><strong>대출 여부</strong></legend>
    <label>
      <input type="radio" name="loan_choice" value="yes" checked />
      대출을 한다
    </label>
    <br />
    <label>
      <input type="radio" name="loan_choice" value="no" />
      대출 없이 자산만으로 부동산 추천
    </label>
  </fieldset>

  <button type="submit" style="margin-top: 1rem">다음 단계로</button>
</form>

<p id="error-message" style="color: red; margin-top: 1rem"></p>

<script>
  const form = document.getElementById("user-form");
  const errorBox = document.getElementById("error-message");

  form.addEventListener("submit", (e) => {
    e.preventDefault();
    errorBox.textContent = "";

    const income_monthly = Number(
      document.getElementById("income_monthly").value || 0
    );
    const credit_score = Number(
      document.getElementById("credit_score").value || 0
    );
    const dsr_ratio = Number(document.getElementById("dsr_ratio").value || 0.4);
    const existing_debt = Number(
      document.getElementById("existing_debt").value || 0
    );
    const existing_debt_monthly_payment = Number(
      document.getElementById("existing_debt_monthly_payment").value || 0
    );
    const married = document.getElementById("married").checked;
    const first_job = document.getElementById("first_job").checked;

    const asset = Number(document.getElementById("asset").value || 0);
    const budget_limit_raw = document.getElementById("budget_limit").value;
    const budget_limit = budget_limit_raw ? Number(budget_limit_raw) : null;
    const target_gu = document.getElementById("target_gu").value || "";

    const w_park = Number(document.getElementById("w_park").value || 5);
    const w_school = Number(document.getElementById("w_school").value || 4);
    const w_mart = Number(document.getElementById("w_mart").value || 3);
    const w_transport = Number(
      document.getElementById("w_transport").value || 2
    );

    if (!income_monthly || !credit_score) {
      errorBox.textContent = "월 소득과 신용점수는 필수입니다.";
      return;
    }

    const userInfo = {
      income_monthly,
      credit_score,
      dsr_ratio,
      existing_debt,
      existing_debt_monthly_payment,
      married,
      first_job,
      asset,
      budget_limit,
      target_gu,
      weights: [w_park, w_school, w_mart, w_transport],
    };

    // localStorage에 저장
    localStorage.setItem("casanova_user_info", JSON.stringify(userInfo));

    // 대출 여부에 따라 분기
    const loanChoice = document.querySelector(
      'input[name="loan_choice"]:checked'
    ).value;

    if (loanChoice === "yes") {
      // 대출 추천 페이지로 이동
      window.location.href = "/loans.html";
    } else {
      // 대출 없이 부동산 추천 → selected_loan_amount = 0으로 설정 후 바로 마지막 페이지로
      localStorage.setItem("casanova_selected_loan_amount", JSON.stringify(0));
      window.location.href = "/properties.html";
    }
  });
</script>
